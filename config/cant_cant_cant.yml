# This configuration file is initialized using `rails g cantcantcant:install`

# The default permission is generated by scanning all non-internal routes
public: &default_permissions
  sessions#new: allow
  sessions#create: allow
  sessions#destroy: allow
  sessions#two_factor_verify: allow
  users/signup#new: allow
  users/signup#create: allow
  users#check_exist: allow
  users/reset_password#new: allow
  users/reset_password#create: allow
  users#create: allow
  users#new: allow

  users#show: deny
  users#update: deny

  verify_codes#create: allow
  settings#unbind_auth: allow
  settings/identifies#create: allow
  settings/edit_email_or_mobile#update: allow
  settings#update_password: allow
  settings#identified: allow
  settings#two_factor_qr: allow
  settings#two_factor: allow
  settings#update_preference: allow

  admin/broadcasts#index: deny
  admin/broadcasts#create: deny
  admin/broadcasts#new: deny

  # api/v1/register#captcha: deny
  # api/v1/register#send_verify_code: deny
  # api/v1/register#register: deny
  # api/v1/users#third_part_login: deny
  # api/v1/users#recommends: deny
  # api/v1/users#extra_info: deny
  # api/v1/users#count: deny
  # api/v1/users#logout: deny
  # api/v1/users#update_preference: deny
  # api/v1/users#show: deny
  # api/v1/users#update: deny
  # api/v1/broadcasts#read_all: deny
  # api/v1/broadcasts#index: deny
  # api/v1/broadcasts#create: deny
  # api/v1/devices#create: deny
  # api/v1/notifications#read: deny
  # api/v1/notifications#read_all: deny
  # api/v1/notifications#index: deny
  # api/v1/notifications#create: deny
  # api/v1/direct_messages#detail: deny
  # api/v1/direct_messages#read_all: deny
  # api/v1/direct_messages#index: deny
  # api/v1/direct_messages#create: deny

user: &user_permissions
  <<: *default_permissions
  users#show: allow
  users#update: allow
  users#access_key: allow

admin:
  <<: *user_permissions
  admin/broadcasts#index: allow
  admin/broadcasts#create: allow
  admin/broadcasts#new: allow
  rails/info#properties: allow
  rails/info#routes: allow
  rails/info#index: allow
  rails/welcome#index: allow
  rails/mailers#index: allow
  rails/mailers#preview: allow
